<link rel="stylesheet" href="style/yenihsppln.css" />
<style>
/* =========================
   2026 GLASS THEME
   wrapper: #ara_content
   ========================= */

/* ANA CARD */
#ara_content .card.p-4{
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06)) !important;
  border: 1px solid rgba(255,255,255,.16) !important;
  border-radius: 18px !important;
  box-shadow: 0 18px 55px rgba(0,0,0,.45) !important;
  backdrop-filter: blur(14px) !important;
  -webkit-backdrop-filter: blur(14px) !important;
  color: rgba(255,255,255,.92) !important;
}

/* GROUP BOX → CAM PANEL */
#ara_content .group-box{
  width: auto !important;
  margin: 10px 0 !important;
  padding: 14px !important;

  border-radius: 18px !important;
  border: 1px solid rgba(255,255,255,.14) !important;
  background: rgba(8,14,26,.35) !important;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.08),
    0 14px 40px rgba(0,0,0,.35);
}

/* FLEX SATIRLAR */
#ara_content .group-box > div{
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}

/* LABEL */
#ara_content label{
  color: rgba(255,255,255,.92) !important;
  font-weight: 900;
  letter-spacing: .2px;
}

/* HESAP ADI LABEL ( ... olanlar ) */
#ara_content label[id^="lbl"]{
  min-height: 44px;
  display: inline-flex;
  align-items: center;
  padding: 8px 12px;

  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(8,14,26,.40);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.08);
}

/* INPUT – CAM */
#ara_content .form-control{
  height: 44px;
  border-radius: 14px !important;
  border: 1px solid rgba(255,255,255,.14) !important;
  background: rgba(8,14,26,.35) !important;
  color: rgba(255,255,255,.92) !important;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.08);
}

#ara_content .form-control::placeholder{
  color: rgba(255,255,255,.55);
}

#ara_content .form-control:focus{
  border-color: rgba(56,189,248,.65) !important;
  box-shadow:
    0 0 0 4px rgba(56,189,248,.18),
    inset 0 1px 0 rgba(255,255,255,.08) !important;
}

/* PRIMARY BUTTON – 2026 SEXY */
#ara_content .btn{
  height: 44px;
  border-radius: 16px;
  font-weight: 900;
}
#ara_content .btn-primary{
  background: rgba(56,189,248,.18) !important;
  border: 1px solid rgba(56,189,248,.35) !important;
  color: rgba(255,255,255,.95) !important;
}
#ara_content .btn-primary:hover{
  background: rgba(56,189,248,.26) !important;
  border-color: rgba(56,189,248,.55) !important;
  transform: translateY(-1px);
}
/* RESPONSIVE TOPARLAMA */
@media (max-width: 900px){
  #ara_content span[style*="padding-left"]{
    display: none !important;
  }
  #ara_content div[style*="width: 125px"]{
    width: 100% !important;
  }
  #ara_content label[id^="lbl"]{
    width: 100% !important;
    margin-top: 6px;
  }
}

#ara_content #errorDiv{
  display:none;
  margin-top: 12px;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(251,113,133,.35);
  background: rgba(251,113,133,.10);
  color: #fff;
  font-weight: 900;
}
</style>


<div class="card p-4">
	<div class="group-box">
		<div style="display: flex; align-items: center; gap: 10px;">
			<label for="label5" style="width: 150px;">Aranacak Kod(Eski)</label>
			<div style="position: relative; width: 125px;">
				<input class="form-control cins_bold" maxlength="12"
					id="tcheskodeski"
					ondblclick="openSecondModal('tcheskodeski', 'carikoddegis')"
					oninput="hesapAdiOgren(this.value, 'lblcheskodeski')">
			</div>
			<span style="padding-left: 80px;"></span> <label for="label5"
				style="width: 160px;">Yazilacak Kod(Yeni)</label>
			<div style="position: relative; width: 125px;">
				<input class="form-control cins_bold"
					ondblclick="openSecondModal('tcheskodyeni', 'carikoddegis')"
					oninput="hesapAdiOgren(this.value,'lblcheskodyeni')" maxlength="12"
					id="tcheskodyeni">
			</div>
		</div>
		<div
			style="display: flex; align-items: center; gap: 10px; margin-top: 7px;">
			<span style="padding-left: 150px;"></span> <label id="lblcheskodeski"
				for="label4" style="width: 350px; font-weight: bold;">...</label> <span
				style="padding-left: 30px;"></span> <label id="lblcheskodyeni"
				for="label5" style="width: 300px; font-weight: bold;">...</label>
		</div>
	</div>
	<br>
	<div class="group-box">
		<button class="btn btn-primary" type="button" id="koddegisButton"
			style="width: 150px;" onclick="kodDegis()">Kaydet</button>
	</div>
</div>
<div id="errorDiv"></div>
<div th:replace="~{modal/yenihsppln :: secondModal}"></div>
<script>

async function kodDegis() {

	const eskiKod = document.getElementById("tcheskodeski").value;
	const yeniKod = document.getElementById("tcheskodyeni").value;
	
	if (!eskiKod || !yeniKod) {
	    alert("Lütfen her iki alanı da doldurun.");
	    return;
	}
	if (eskiKod === yeniKod) {
	    alert("Eski kod ile yeni kod aynı olamaz.");
	    return;
	}
    document.getElementById("errorDiv").style.display = "none";
    document.getElementById("errorDiv").innerText = "";
    
    document.body.style.cursor = "wait";
	const $kaydetButton = $('#koddegisButton');
	$kaydetButton.prop('disabled', true).text('Islem Yapiliyor...');

	   try {
	        const response = await fetchWithSessionCheck("cari/koddegiskaydet", {
	        	method: 'POST',
	        	headers: {
					'Content-Type': 'application/x-www-form-urlencoded',
				},
				body: new URLSearchParams({ eskiKod: eskiKod , yeniKod:yeniKod }),
	        });
			if (response.errorMessage) {
				throw new Error(response.errorMessage);
			}
			document.body.style.cursor = "default";
			setTimeout(() => {
				 alert("Islem Basari ile gerceklestirildi");
			}, 100);
	    } catch (error) {
	        document.getElementById("errorDiv").style.display = "block";
	        document.getElementById("errorDiv").innerText = error.message || "Beklenmeyen bir hata oluştu.";
	    } finally {
	    	document.body.style.cursor = "default";
			$kaydetButton.prop('disabled', false).text('Kaydet');
	     }
	}
</script>